from Crypto.Util.number import inverse, long_to_bytes, GCD

N = 9288011389664837847963670837039196937548434573294469245501561784245642854634445047
outputs = [7827437377925724428078233147899924081225364249930858942421079276821876942757073519,
           8887391738833944793881713037947023989163050343070393147424888589467627754249865604,
           8081548039727189478984198619032683177557008617453299085364096689176320484341697433,
           2275794279542811986322743644529192750108107184530803067791576158460846098638595919,
           6253142316263707598596838911072529989608774170182629190175128689020135811837569575,
           4733751513227945548879795301848782446340444473234631092994528819564169644364997232,
           7059294752711247585748476830322929650455626597483726834273561488576645863895400850,
           3416115616735235302679100710807631760495960686259891905227746706138654756842094326,
           8925820570540264143648581237815478995705636946118008059750128065916255778832895553,
           2892105289971843001930724217759034130633547138605066058109243908372747042621581984,
           314392853155476706788704773868088966795343394149871206877830575819199838027511362,
           4327945167964771727885647567828770187834470062965467452997985192630056416939883267,
           5004179351047061632898561578033712835850283897910028694457603173176131447102750100]
ratios = []

for i in range(len(outputs) - 1):
    c_current = outputs[i]
    c_next = outputs[i+1]
    val = (pow(c_current, 3, N) * inverse(c_next, N)) % N
    ratios.append(val)

unique_ratios = list(set(ratios))
r1 = unique_ratios[0]
r2 = unique_ratios[1]

diff = (r1 * inverse(r2, N)) % N
candidates_m_N = [diff, inverse(diff, N)]


def egcd(a, b):
    if a == 0:
        return (b, 0, 1)
    else:
        g, y, x = egcd(b % a, a)

        return (g, x - (b // a) * y, y)


for m_N in candidates_m_N:
    inv_R0 = inverse(ratios[0], N)

    for k0 in range(4):
        term_k = pow(m_N, k0, N)
        m_1337 = (term_k * inv_R0) % N
        g, x, y = egcd(N, 1337)

        if g != 1:
            continue

        m_candidate = (pow(m_N, x, N) * pow(m_1337, y, N)) % N
        dec = long_to_bytes(m_candidate)

        if b'Alpaca' in dec:
            print(f"k = {k0}, m = {dec}")

            break
